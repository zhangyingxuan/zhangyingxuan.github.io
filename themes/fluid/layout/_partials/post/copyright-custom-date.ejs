<% if (theme.post.copyright.enable && page.copyright !== false) { %>
  <%
    var license = theme.post.copyright.license || ''
    if (typeof page.copyright === 'string') {
      license = page.copyright
    } else if (typeof page.license === 'string') {
      license = page.license
    }
    license = license.toUpperCase()
  %>

  <% 
    const title = page.title;
    const regex = /(\d{4}-\d{2}-\d{2})/;  // 匹配 YYYY-MM-DD
    const match = title.match(regex);
    let displayDate;

    if (match) {
      // 提取日期字符串并转换为日期对象（供格式化）
      const dateObj = new Date(match[1]);  // 如 "2024-05-20" → Date 对象
      // 按自定义格式渲染（支持 Moment.js 语法，如 YYYY年MM月DD日）
      displayDate = date(dateObj, 'YYYY年MM月DD日');  // 结果："2024年05月20日"
      // 或用主题全局配置：displayDate = date(dateObj, config.date_format);
    } else {
      // 无标题日期时用默认 date 字段（按主题配置的 date_format 格式化）
      displayDate = full_date(page.date, theme.post.copyright.post_date.format || 'LL');
    }
  %>

  <div class="license-box my-3">
    <div class="license-title">
      <div><%= page.title %></div>
      <div><%= decode_url(page.permalink) %></div>
    </div>
    <div class="license-meta">
      <% if (theme.post.copyright.author.enable && (page.author || config.author)) { %>
        <div class="license-meta-item">
          <div><%- __('post.copyright.author') %></div>
          <div><%- page.author || config.author %></div>
        </div>
      <% } %>
      <% if (theme.post.copyright.post_date.enable && page.date) { %>
        <div class="license-meta-item license-meta-date">
          <div><%- __('post.copyright.posted') %></div>
          <div><%= displayDate %></div>
        </div>
      <% } %>
      <% if (theme.post.copyright.update_date.enable && page.updated && compare_date(page.date, page.updated)) { %>
        <div class="license-meta-item license-meta-date">
          <div><%- __('post.copyright.updated') %></div>
          <div><%= full_date(page.updated, theme.post.copyright.update_date.format || 'LL') %></div>
        </div>
      <% } %>
      <% if (license) { %>
        <div class="license-meta-item">
          <div><%- __('post.copyright.licensed') %></div>
          <div>
            <% if (['BY', 'BY-SA', 'BY-ND', 'BY-NC', 'BY-NC-SA', 'BY-NC-ND'].indexOf(license) !== -1) { %>
              <% var items = license.split('-') %>
              <% for (var idx = 0; idx < items.length; idx++) { %>
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/<%= license.toLowerCase() %>/4.0/">
                  <span class="hint--top hint--rounded" aria-label="<%- __('post.copyright.' + items[idx]) %>">
                    <i class="iconfont icon-cc-<%= items[idx].toLowerCase() %>"></i>
                  </span>
                </a>
              <% } %>
            <% } else if (license === 'ZERO') {  %>
              <a class="print-no-link" target="_blank" href="https://creativecommons.org/publicdomain/zero/1.0/">
                <span class="hint--top hint--rounded" aria-label="<%- __('post.copyright.ZERO') %>">
                  <i class="iconfont icon-cc-zero"></i>
                </span>
              </a>
            <% } else { %>
              <%- license %>
            <% } %>
          </div>
        </div>
      <% } %>
    </div>
    <div class="license-icon iconfont"></div>
  </div>
<% } %>
