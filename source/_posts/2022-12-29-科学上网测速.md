---
title: 2022-12-29-科学上网测速
description:
categories:
  - 工程化
tags:
  - nuxt3
---

测试科学上网（VPN/Proxy）的带宽上限比测试普通宽带要复杂，因为流量经过了**加密**、**混调**以及**中转服务器**。要测出真实的“天花板”，建议采用由浅入深的三步法：

---

### 1. 基础测试：多线程测速（Speedtest）

普通的网页版 Speedtest 往往测不准，因为单线程下加密开销会导致数据抖动。

- **工具**：[Speedtest.net](https://www.speedtest.net/) 官网或客户端。
- **要点**：
- **手动更换节点**：不要使用默认的自动选择，应手动将测试服务器切换到**代理服务器所在的地区**（例如你的节点是日本，就选东京的服务器）。
- **开启多线程**：在设置中确保处于 "Multi" 模式。

- **解读**：如果测得 200Mbps，说明代理服务器到目标测速点的链路至少能支撑这个速度。

---

### 2. 压力测试：YouTube 4K/8K 缓冲（最直观）

这是最贴近实际使用场景的测试，能反映出代理软件（如 Clash, V2Ray）的实时解密处理能力。

- **方法**：
- 打开 YouTube，搜索 `8K 60FPS Video`。
- 右键点击视频，选择 **“详细统计信息” (Stats for nerds)**。

- **看哪个指标**：
- **Connection Speed**：这是实时下行带宽。
- **Buffer Health**：如果进度条缓冲一直保持在 20-30s 以上，说明带宽上限远超视频码率。
- **注意**：YouTube 测速存在瞬时性，建议多快进几次看峰值速度。

---

### 3. 进阶测试：iPerf3 端到端测速（最精准）

如果你有一台海外服务器，使用 iPerf3 可以排除第三方干扰，直接测试你家到服务器之间的 **TCP/UDP 最大吞吐量**。

- **服务端（海外服务器）执行**：
  `iperf3 -s`
- **本地客户端（通过代理软件运行）执行**：
  `iperf3 -c [服务器IP] -P 8 -t 10`
  _(参数说明：-P 8 代表开启 8 条并行流，-t 10 测试 10 秒)_
- **核心优势**：它可以直接反映出 ISP 是否对特定协议进行了 **QoS（限速）**。

---

### 4. 影响上限的“隐形因素”排查

如果测出来的速度远低于你的宽带容量，通常是以下环节出了问题：

#### A. 加密协议开销

- **原因**：旧的协议或过强的加密算法会大量消耗 CPU。
- **排查**：观察测速时电脑/路由器的 **CPU 占用率**。如果 CPU 某一核心满载，那么 CPU 性能就是你的带宽上限。

#### B. 代理模式差异

- **TUN 模式 vs 系统代理**：TUN 模式（虚拟网卡）通常比系统代理（HTTP/Socks5）性能略低，但在处理多连接时更稳定。

#### C. MTU 与分片

- **现象**：网页能打开，但大文件下载极慢或无法完成。
- **优化**：尝试在代理软件中调整 MTU 值（通常设为 1400 或 1350），避免因数据包过大被链路直接丢弃。

---

### 总结建议

如果你是想看你的“机场”或“自建服务器”是否达标：

1. **先看 Speedtest 峰值**（判断服务器带宽）；
2. **再看 YouTube Stats for nerds**（判断真实使用体验）；
3. **最后用 iPerf3**（判断线路是否被运营商针对性限速）。
