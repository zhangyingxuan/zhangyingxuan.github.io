---
title: 2025-01-06-【研发】pm2日志管理
description:
categories:
  - 工程化
tags:
  - pm2
---

要使用 PM2 管理日志文件并按大小进行分隔，你可以使用 pm2-logrotate 插件。以下是详细的步骤和配置方法：

安装 pm2-logrotate 插件
首先，确保你已经安装了 PM2。然后，安装 pm2-logrotate 插件：

```bash
pm2 install pm2-logrotate
安装完成后，你可以通过 pm2 list 查看模块列表
```

配置 pm2-logrotate
安装完成后，你可以通过以下命令来配置日志轮换的参数：

设置日志文件的最大大小：

```bash
pm2 set pm2-logrotate:max_size 10M
这里设置日志文件的最大大小为 10MB
```

设置保留的日志文件数量：

```bash
pm2 set pm2-logrotate:retain 10
这里设置最多保留 10 个日志文件
```

启用日志文件压缩：

```bash
pm2 set pm2-logrotate:compress true
启用 gzip 压缩处理日志文件
```

设置日志文件名称的日期格式：

```bash
pm2 set pm2-logrotate:dateFormat "YYYY-MM-DD_HH-mm-ss"
设置日志文件名的日期格式
```

设置检查日志大小的时间间隔：

```bash
pm2 set pm2-logrotate:workerInterval 30
设置为每 30 秒检查一次日志大小
```

设置定时强制分割日志文件的时间：

```bash
pm2 set pm2-logrotate:rotateInterval "0 0 \* \* \*"
设置为每天午夜 0 点强制分割日志文件
```

查看和重启配置
查看当前配置：

```bash
pm2 conf pm2-logrotate
或者
```

```bash
pm2 show pm2-logrotate
查看当前的 pm2-logrotate 配置
```

重启所有应用以应用新的日志配置：

```bash
pm2 restart all
确保新的日志配置生效
```
